# -*- coding: utf-8 -*-
"""
@author: Yueru wen
"""



import time

from Py6S import *



def ac_6s(uaot,solz,viewz,alt,band,wv,O3,raa):
    s = SixS() 
  
    s.geometry = Geometry.User()
    s.geometry.solar_z = solz 
    s.geometry.view_z = viewz  
    s.geometry.solar_a = raa 
    s.geometry.view_a = 0  
  
    s.atmos_profile = AtmosProfile.UserWaterAndOzone(wv,O3)
    s.aero_profile = AeroProfile.PredefinedType(AeroProfile.Continental)
    s.aot550 = uaot 
    s.altitudes.set_sensor_satellite_level()
    s.altitudes.set_target_custom_altitude(alt)
   
    if band==1:
        s.wavelength = Wavelength(0.405,0.57,[0.00122100,0.00245400,0.00411300,0.00620050,0.00847300, 0.0108225
, 0.0145881, 0.0215956, 0.0322260, 0.0487256, 0.0737350,  0.110009
,  0.158875,  0.222939,  0.290139,  0.357993,  0.453734,  0.559919
,  0.636331,  0.720971,  0.813045,  0.861679,  0.898431,  0.944343
,  0.973934,  0.987873,  0.996641,  0.999889,  0.990573,  0.954506
,  0.891933,  0.827618,  0.798528,  0.772096,  0.709707,  0.620790
,  0.532701,  0.460644,  0.390935,  0.319106,  0.251296,  0.188732
,  0.134744, 0.0947669, 0.0657030, 0.0453087, 0.0316910, 0.0234634
, 0.0181080, 0.0140280, 0.0107160,0.00833448,0.00655504,0.00506348
,0.00371503,0.00262449,0.00189801,0.00159350,0.00153800,0.00159600
,0.00165300,0.00165700,0.00161000,0.00154550,0.00149000,0.00150850
,0.00151200])

    elif band==2:
        s.wavelength = Wavelength(0.4225,1,[0.00111850,0.00125300,0.00137400,0.00150400,0.00162200
,0.00172900,0.00182800,0.00186500,0.00186500,0.00195600,0.00201600
,0.00193700,0.00187300,0.00181500,0.00165550,0.00148100,0.00133800
,0.00121600,0.00114100,0.00111800,0.00113550,0.00121500,0.00152400
,0.00190800,0.00235050,0.00288700,0.00337500,0.00359200,0.00349350
,0.00318700,0.00281950,0.00305400,0.00404050,0.00567700,0.00825746
, 0.0119180, 0.0180314, 0.0276270, 0.0402733, 0.0564990, 0.0779148
,  0.104722,  0.136346,  0.171432,  0.215162,  0.271255,  0.339219
,  0.405546,  0.459252,  0.505374,  0.547421,  0.587635,  0.618577
,  0.641262,  0.663067,  0.689272,  0.719488,  0.746020,  0.764762
,  0.778436,  0.790805,  0.804211,  0.819823,  0.839755,  0.866218
,  0.897527,  0.923143,  0.935753,  0.934337,  0.929780,  0.936474
,  0.955457,  0.980575,  0.998003,  0.996149,  0.977073,  0.953245
,  0.934508,  0.925032,  0.920470,  0.918203,  0.918161,  0.917372
,  0.910667,  0.892667,  0.862206,  0.820744,  0.779192,  0.748259
,  0.733873,  0.738573,  0.755265,  0.772178,  0.782483,  0.784525
,  0.782005,  0.779390,  0.780855,  0.786540,  0.792671,  0.792630
,  0.783916,  0.767258,  0.749438,  0.739020,  0.743412,  0.765422
,  0.796896,  0.829482,  0.854191,  0.863654,  0.863690,  0.858217
,  0.847974,  0.834670,  0.821562,  0.811635,  0.808100,  0.814896
,  0.831187,  0.856571,  0.887692,  0.913798,  0.926985,  0.927582
,  0.913852,  0.880481,  0.835416,  0.783423,  0.726249,  0.666929
,  0.607717,  0.546658,  0.485471,  0.426974,  0.369802,  0.314096
,  0.261460,  0.214384,  0.173231,  0.137849,  0.107944, 0.0843627
, 0.0660130, 0.0526346, 0.0432562, 0.0374126, 0.0339881, 0.0322215
, 0.0311270, 0.0300220, 0.0287220, 0.0272800, 0.0258670, 0.0244730
, 0.0230700, 0.0217410, 0.0205930, 0.0197445, 0.0191550, 0.0187800
, 0.0185280, 0.0183550, 0.0182200, 0.0180945, 0.0179460, 0.0177455
, 0.0175160, 0.0173020, 0.0171330, 0.0168710, 0.0163760, 0.0156225
, 0.0148880, 0.0144675, 0.0140590, 0.0134605, 0.0127490, 0.0119360
, 0.0110420, 0.0101145,0.00919400,0.00830450,0.00747000,0.00671451
,0.00603600,0.00544801,0.00494800,0.00455100,0.00426600,0.00412350
,0.00408200,0.00411650,0.00419600,0.00428750,0.00436100,0.00439050
,0.00435600,0.00423800,0.00406200,0.00384750,0.00361400,0.00338100
,0.00316500,0.00297600,0.00282400,0.00273450,0.00269200,0.00268800
,0.00270300,0.00272850,0.00275200,0.00275900,0.00273700,0.00268100
,0.00260000,0.00250000,0.00239100,0.00228250,0.00218300,0.00209750
,0.00203400,0.00200000,0.00197800,0.00195700,0.00193100,0.00189200
,0.00184000,0.00177250,0.00168600,0.00158650,0.00147900])

    elif band==3:
        s.wavelength = Wavelength(0.62,1.02,[0.0102630,0.0104645,0.0106650,0.0108225
,0.0108850,0.0108020,0.0105770,0.0102355,0.00987600,0.00959500
,0.00945200,0.00945100,0.00951000,0.00949100,0.00934300,0.00908700
,0.00880501,0.00858300,0.00848400,0.00854750,0.00874999,0.00905700
,0.00945499,0.00997601,0.0106160,0.0113960,0.0123270,0.0133820
,0.0144920,0.0156170,0.0167060,0.0177195,0.0187590,0.0198990
,0.0211000,0.0223530,0.0236650,0.0250785,0.0266220,0.0284410
,0.0309800,0.0349349,0.0408020,0.0491064,0.0598830,0.0738963
,0.0910960, 0.111600, 0.136057, 0.166187, 0.202699, 0.247654
, 0.300493, 0.359695, 0.423503, 0.491830, 0.560534, 0.624922
, 0.682958, 0.735984, 0.787417, 0.834852, 0.876334, 0.909348
, 0.931481, 0.940556, 0.939279, 0.929433, 0.915893, 0.904236
, 0.901483, 0.914082, 0.934357, 0.956715, 0.979511, 0.995075
,  1.00000, 0.995366, 0.985835, 0.975329, 0.964253, 0.951838
, 0.937584, 0.921016, 0.903261, 0.887277, 0.874504, 0.865618
, 0.860739, 0.861982, 0.870228, 0.873702, 0.862813, 0.843481
, 0.831388, 0.840177, 0.850885, 0.848334, 0.833645, 0.804715
, 0.766377, 0.726298, 0.691369, 0.666806, 0.651909, 0.645818
, 0.645702, 0.649404, 0.653748, 0.654704, 0.649548, 0.635561
, 0.612421, 0.579855, 0.540292, 0.494571, 0.442146, 0.381274
, 0.310871, 0.230481, 0.149675,0.0793373,0.0359260,0.0323855
,0.0299540,0.0281235,0.0265100,0.0250640,0.0237400,0.0225015
,0.0212910,0.0201195,0.0189390,0.0177675,0.0165670,0.0153945
,0.0142560,0.0131975,0.0122020,0.0113245,0.0105600,0.00990251
,0.00938001,0.00895900,0.00861101,0.00828250,0.00799801,0.00771750
,0.00746100,0.00722750,0.00701100,0.00682100,0.00665600,0.00652800
,0.00644200,0.00641500,0.00645200,0.00653400,0.00668300,0.00689449
,0.00713700])

    elif band==4:
        s.wavelength = Wavelength(1.33,1.42,[0.00219799,0.00381950
,0.00542294,0.00794102,0.00908100, 0.0128653,0.0229180,0.0403188
,0.0754470,0.120782,0.227541,0.397469,0.607595,0.803355
,0.935022,0.988922,1.00000,0.993143,0.981043,0.976291
,0.979434,0.977890,0.944934,0.818680,0.591225,0.379517
,0.218233,0.116494,0.0634260,0.0487993,0.0258840,0.0168539
, 0.0132790,0.0100274,0.00576400,0.00361050,0.00208500])
 
    elif band==5:
        s.wavelength = Wavelength(1.5475,1.6675,[0.0106250, 0.0118780, 0.0139365, 0.0183610, 0.0242645
, 0.0326770, 0.0420755, 0.0557172, 0.0788225,  0.111320,  0.158729
,  0.223553,  0.320612,  0.450022,  0.599161,  0.750039,  0.873066
,  0.950109,  0.980669,  0.986807,  0.981045,  0.977549,  0.976513
,  0.976639,  0.983669,  0.992962,  0.998584,1.00000,  0.996496
,  0.981578,  0.961781,  0.915208,  0.843479,  0.744737,  0.626199
,  0.502247,  0.385349,  0.285679,  0.208936,  0.151265,  0.108544
, 0.0761520, 0.0540044, 0.0381800, 0.0276122, 0.0218780, 0.0168944
, 0.0133700, 0.0113115])

    elif band==6: 
        s.wavelength = Wavelength(2.0125,2.505,[0.0107122,0.0122541,0.0135947,0.0148009,0.0165052
,0.0185415,0.0211679,0.0241881,0.0272546,0.0303526,0.0343184
,0.0388628,0.0438734,0.0491947,0.0552448,0.0617800,0.0694600
,0.0779023,0.0879680,0.0991158, 0.111766, 0.125419, 0.141168
, 0.158314, 0.177406, 0.197793, 0.219665, 0.242525, 0.268731
, 0.297166, 0.325011, 0.352461, 0.381243, 0.410910, 0.437679
, 0.462513, 0.487514, 0.512628, 0.534888, 0.555246, 0.572265
, 0.587062, 0.601584, 0.615925, 0.627575, 0.637430, 0.646197
, 0.654237, 0.662353, 0.670520, 0.677843, 0.684606, 0.692252
, 0.700485, 0.706794, 0.711820, 0.716858, 0.721905, 0.727978
, 0.734735, 0.741258, 0.747624, 0.754131, 0.760733, 0.766550
, 0.771844, 0.777166, 0.782506, 0.790084, 0.799154, 0.806907
, 0.813783, 0.819944, 0.825628, 0.830854, 0.835775, 0.840833
, 0.845983, 0.849504, 0.851941, 0.856896, 0.863529, 0.870183
, 0.876849, 0.879789, 0.880244, 0.884264, 0.890660, 0.891797
, 0.889427, 0.891455, 0.896417, 0.900067, 0.902845, 0.907385
, 0.913100, 0.918451, 0.923559, 0.928386, 0.933026, 0.936628
, 0.939537, 0.945912, 0.954597, 0.960777, 0.965285, 0.971105
, 0.977799, 0.983302, 0.988009, 0.990493, 0.991496, 0.992157
, 0.992591, 0.992687, 0.992557, 0.988883, 0.982843, 0.972046
, 0.958075, 0.944484, 0.931147, 0.911737, 0.888276, 0.863544
, 0.837964, 0.810537, 0.781873, 0.751158, 0.719075, 0.683105
, 0.644537, 0.608490, 0.574123, 0.538937, 0.503199, 0.468881
, 0.435509, 0.405385, 0.377421, 0.350312, 0.323774, 0.299991
, 0.278047, 0.258011, 0.239249, 0.222191, 0.206270, 0.191306
, 0.176981, 0.164343, 0.152829, 0.141794, 0.131079, 0.121877
, 0.113684, 0.106517, 0.100036,0.0932357,0.0862231,0.0798870
,0.0740026,0.0691459,0.0649749,0.0613916,0.0582006,0.0547532
,0.0511349,0.0477101,0.0444137,0.0422957,0.0409634,0.0388993
,0.0363471,0.0340893,0.0320278,0.0309129,0.0304287,0.0295397
,0.0283807,0.0264145,0.0239100,0.0214988,0.0191500,0.0181540
,0.0180597,0.0172326,0.0159167,0.0149269,0.0141541,0.0133952
,0.0126454,0.0121807,0.0119059,0.0117688,0.0117236,0.0111440
,0.0102083])
    else:
        print('error!')
       
    s.atmos_corr = AtmosCorr.AtmosCorrLambertianFromReflectance(0.02)
    s.run()
    f1 = 1/(s.outputs.transmittance_total_scattering.total*s.outputs.transmittance_global_gas.total)
    return (f1, s.outputs.coef_xb, s.outputs.coef_xc)

start=time.time()

(xa,xb,xc)=ac_6s(0.02,30,45,0.5,1,2,0.28,25)
print(xa,xb,xc)
print('Total Hours:',(time.time()-start)/3600.)


